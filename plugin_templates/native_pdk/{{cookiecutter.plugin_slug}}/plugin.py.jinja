"""{{ cookiecutter.description }}.

Copyright 2025
SPDX-License-Identifier: Apache-2.0
Authors: {{ cookiecutter.author }}

This module loads configurations for plugins.
"""

# First-Party
from mcpgateway.plugins.framework import (
    Plugin,
    PluginConfig,
    PluginContext,
    PromptPosthookPayload,
    PromptPosthookResult,
    PromptPrehookPayload,
    PromptPrehookResult,
    ToolPostInvokePayload,
    ToolPostInvokeResult,
    ToolPreInvokePayload,
    ToolPreInvokeResult,
)
from mcpgateway.plugins.framework.helpers import get_plugin_logger, get_config_value


class {{ cookiecutter.plugin_class_name }}(Plugin):
    """{{ cookiecutter.description }}."""

    def __init__(self, config: PluginConfig):
        """Entry init block for plugin.

        Args:
          config: The plugin configuration.
        """
        super().__init__(config)
        self.logger = get_plugin_logger("{{ cookiecutter.plugin_slug }}")
        self.logger.info("{{ cookiecutter.plugin_name }} initialized.")

    async def prompt_pre_fetch(self, payload: PromptPrehookPayload, context: PluginContext) -> PromptPrehookResult:
        """The plugin hook run before a prompt is retrieved and rendered.

        Args:
            payload: The prompt payload to be analyzed.
            context: contextual information about the hook call.

        Returns:
            The result of the plugin's analysis, including whether the prompt can proceed.
        """
        self.logger.debug(f"prompt_pre_fetch called for prompt: {payload.name}")
        return PromptPrehookResult(continue_processing=True)

    async def prompt_post_fetch(self, payload: PromptPosthookPayload, context: PluginContext) -> PromptPosthookResult:
        """Plugin hook run after a prompt is rendered.

        Args:
            payload: The prompt payload to be analyzed.
            context: Contextual information about the hook call.

        Returns:
            The result of the plugin's analysis, including whether the prompt can proceed.
        """
        return PromptPosthookResult(continue_processing=True)

    async def tool_pre_invoke(self, payload: ToolPreInvokePayload, context: PluginContext) -> ToolPreInvokeResult:
        """Plugin hook run before a tool is invoked.

        Args:
            payload: The tool payload to be analyzed.
            context: Contextual information about the hook call.

        Returns:
            The result of the plugin's analysis, including whether the tool can proceed.
        """
        self.logger.info(f"tool_pre_invoke called for tool: {payload.name}")

        # Example of getting a value from the plugin's configuration
        greeting = get_config_value(context, "greeting", "Hello")
        self.logger.info(f"{greeting} from the {{ cookiecutter.plugin_name }}!")

        return ToolPreInvokeResult(continue_processing=True)

    async def tool_post_invoke(self, payload: ToolPostInvokePayload, context: PluginContext) -> ToolPostInvokeResult:
        """Plugin hook run after a tool is invoked.

        Args:
            payload: The tool result payload to be analyzed.
            context: Contextual information about the hook call.

        Returns:
            The result of the plugin's analysis, including whether the tool result should proceed.
        """
        return ToolPostInvokeResult(continue_processing=True)
